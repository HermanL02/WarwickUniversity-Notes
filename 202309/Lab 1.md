# Task 1
## 1.1 Results and Screenshots

The three mentioned cipher types was used to encrypt and decrypt. During the experiment, the `-AES-128-ECB` cipher does not require a iv, because it encrypt each block individually, and does not rely on the previous block's encryption result. 
![[Pasted image 20231116115820.png|650]]

Below is the screenshot that shows the warning. 
![[Pasted image 20231116121812.png|650]]
## 1.2 Deprecated Key Derivation Warning
`Deprecated key derivation used` is a warning is due to no salting is used in the encrypting algorithm, which makes the encryption susceptible to brute-force attacks. 
## 1.3 -pbkdf2
PBKDF2 enhances security by using HMAC and salting. It repeatedly adds random values to generate the derivation keys, which are then used as the new encryption key, which **increases the cost and difficulty of brute force attacks**. Most importantly, this approach can avoid the hackers to use the precomputed table to attack the password. 

# Task 2
## 2.1 Results and Screenshots
Below is the screenshot of the photos generated by using the encrypted body with `-AES-128-ECB` and `-AES-128-CBC`respectively, and the same original bmp photo header. 
The encryption using `-AES-128-ECB`: 
![[Pasted image 20231116124541.png|650]]
The encryption using `-AES-128-CBC`: 
![[Pasted image 20231116124510.png|650]]

## 2.2 Diagrams of `-AES-128-CBC` and `-AES-128-ECB`
The diagram of the `-AES-128-ECB`. Each plaintext is individually encrypted. It does not have any connections with any previous blocks. 
![[Drawing 2023-11-16 15.09.03.excalidraw|650]]
The diagram of the`-AES-128-CBC`. Each plaintext block does XOR with the previous ciphertext block. For the first plaintext block, it does the XOR operation with the random initial value (IV).  
![[Drawing 2023-11-16 15.30.36.excalidraw|650]]
## 2.3 Difference between the two Outputs
## Results
From the image we obtained from [[Lab 1#2.1 Results and Screenshots]]. 
The image of `-AES-128-ECB` has a clear shape of the original image. On the contrary, the image of `-AES-128-CBC` has no shape clearly shown. 

## Difference 
When encrypting the same colour (the same data in a more general case), the`-AES-128-ECB` mode generates the same encryption code, which means it cannot encrypt the patterns of data. It is not safe, because some features can still be seen even after the encryption. 
When encrypting the same data with `-AES-128-CBC` mode instead, it connects each part with the previous block, which prevents the attacker to see the pattern. 

# Task 3
## 3.1 Results and Screenshots
The following commands was used to generate a decrypted file with paddings. 
![[Pasted image 20231117171351.png]]
The content of the decrypted files. 
![[Pasted image 20231117171416.png]]

## 3.2 the Size of the Files
Each file has a size of 16 bytes 's multiple number, e.g.. 16, 32...

It was found that if the encrypted file contains **5** character, the padding's length is 11; if the encrypted file contains **10** character, the padding's length is 6;  if the encrypted file only contains **16** character, the padding's length is 16. 

Therefore, we can conclude that if the file size is not a multiple of 16, it uses a padding of that the length can increase the size to the multiple of 16. (e.g. a file contains 7 bytes, then it requires 16 - 7 padding to make the file size to 16) 
If the file size is a multiple of 16, it uses a 16 byte long padding. 
(e.g. 16->32, 32->48)

## 3.3 the Values Used in the Paddings

It was found that if the encrypted file contains **5** character, the padding filled is **0b**, which is **11** in decimal; if the encrypted file contains **10** character, the padding filled is **06** in decimal;  if the encrypted file only contains **16** character, the padding filled is **10**, which is **16** in decimal. 

It is the PKCS#5 padding which is mentioned in the question, and during the decryption process, we can 
1. check the last repetitive bytes of the data file to see how many padding bytes are required to be deleted, 
2. check the consistency of the final bytes, 
3. separate the paddings and the data. 

# Task 4
## 4.1 Results and Screenshots
By uploading the text to the website, a statistics of the original text is shown below with character separate frequency, bigrams frequency and trigrams frequency. 
Character frequency:
![[Pasted image 20231118174303.png|650]]
Bigrams frequency: 
![[Pasted image 20231118180719.png|650]]
Trigrams frequency: 
![[Pasted image 20231118180753.png|650]]
Plaintext:
![[Pasted image 20231118180903.png]]
## 4.2 Process of Analysis
### General Idea
During the analysis, I think frequency analysis is the essential first step, then the ==Test and Verify== would be easier. My thinking is that we can use frequency analysis to find the most obvious ones, then we use ==Test and Verify== to finish the rest. 
### Detailed Steps
#### Trigram Part
1. By looking the ==trigram== picture first, we can get 'ytn' is 'THE', because they got a 2.21% and 1.81%, which are way more than the second largest frequency. 
2. We can also notice that the 'vup' is 'AND' by using the same method. 
#### Bigram Part
1. By looking the ==bigram== picture then, we know u is N, then we can conclude 'm' is 'I', because 'mu' and 'IN' got 2.04% and 2.43% separately, and they have the second N in common. 
2. By looking 'nh' and 'ER', we can confirm 'h' is 'R', because 'n' is confirmed to be 'E', and they have a 1.93% and 2.05% separately. 
3. By looking 'vu' and 'AN', we can confirm 'v' is 'A' because of 'u' is 'N', and they have 1.63% and 1.99% separately. 'hn' and 'RE' could confirm the previous result. 

By now, we know that 'ytnvupmh' 's corresponding letters. (During the test, we can try more, but since then we cannot get a visualized accurate answer. ) Then I would use =='Test and Verify'==. 
#### Test and Verify

1. We may notice that 'RIrHT AbTER'  'RIGHT AFTER', we can know 'rb' is 'GF'. 
2. 'EkTRA' can let us know 'k' is 'X'
3. 'DREAc' can let us know 'c' is 'M'
4. 'qEEMq' can let us know 'q' is 'S'
5. 'eRESIDENT' can make 'e' be 'P'
6. 'SzPPxRT' can make 'zx' be "UO"
7. 'GOiDEN' can make 'i' be 'L'
8. 'aEREMONd' can make me think 'CEREMONY' 
9. 'AgOUT' can make me think 'ABOUT'
10. 'lEEsEND' can be 'WEEKEND'
11. 'DIfISIfE' can be 'DIVERSIVE'
12. Prize and Just
### Answer Table
By doing the above analysis, we can conclude the following answers. 

| Plain | Cipher |
|-------|--------|
| A     | v      |
| B     | g      |
| C     | a      |
| D     | p      |
| E     | n      |
| F     | b      |
| G     | r      |
| H     | t      |
| I     | m      |
| J     | o      |
| K     | s      |
| L     | i      |
| M     | c      |
| N     | u      |
| O     | x      |
| P     | e      |
| Q     | j      |
| R     | h      |
| S     | q      |
| T     | y      |
| U     | z      |
| V     | f      |
| W     | l      |
| X     | k      |
| Y     | d      |
| Z     | w      |

